import{shallowRef as e,ref as o,computed as l,watch as a,createVNode as t,mergeProps as n,Fragment as u}from"/Users/alexandarvalov/Documents/GitHub/nzis-import-app/node_modules/vue/index.mjs";import{makeVConfirmEditProps as i,VConfirmEdit as r}from"../../components/VConfirmEdit/VConfirmEdit.mjs";import{makeVDatePickerProps as s,VDatePicker as m}from"../../components/VDatePicker/VDatePicker.mjs";import{VMenu as d}from"../../components/VMenu/VMenu.mjs";import{makeVTextFieldProps as c,VTextField as v}from"../../components/VTextField/VTextField.mjs";import{useDisplay as p,makeDisplayProps as f}from"../../composables/display.mjs";import{useFocus as y,makeFocusProps as V}from"../../composables/focus.mjs";import{forwardRefs as j}from"../../composables/forwardRefs.mjs";import{useLocale as b}from"../../composables/locale.mjs";import{useProxiedModel as h}from"../../composables/proxiedModel.mjs";import{useDate as D}from"../../composables/date/date.mjs";import{genericComponent as F}from"../../util/defineComponent.mjs";import{propsFactory as g}from"../../util/propsFactory.mjs";import{wrapInArray as k,omit as A}from"../../util/helpers.mjs";import{useRender as C}from"../../util/useRender.mjs";const P=g({displayFormat:[Function,String],location:{type:String,default:"bottom start"},...f(),...V(),...i({hideActions:!0}),...c({placeholder:"mm/dd/yyyy",prependIcon:"$calendar"}),...A(s({hideHeader:!0,showAdjacentMonths:!0}),["active","location","rounded"])},"VDateInput"),x=F()({name:"VDateInput",props:P(),emits:{save:e=>!0,cancel:()=>!0,"update:modelValue":e=>!0},setup(i,s){let{emit:c,slots:f}=s;const{t:V}=b(),F=D(),{mobile:g}=p(i),{isFocused:P,focus:x,blur:w}=y(i),M=h(i,"modelValue",i.multiple?[]:null,(e=>Array.isArray(e)?e.map((e=>F.toJsDate(e))):e?F.toJsDate(e):e),(e=>Array.isArray(e)?e.map((e=>F.date(e))):e?F.date(e):e)),U=e(!1),S=e(!1),$=o(),E=o(["save"]);function I(e){return"function"==typeof i.displayFormat?i.displayFormat(e):F.format(e,i.displayFormat??"keyboardDate")}const H=l((()=>{const e=k(M.value);if(!e.length)return null;if(!0===i.multiple)return V("$vuetify.datePicker.itemsSelected",e.length);if("range"===i.multiple){const o=e[0],l=e[e.length-1];return F.isValid(o)&&F.isValid(l)?`${I(F.date(o))} - ${I(F.date(l))}`:""}return F.isValid(M.value)?I(F.date(M.value)):""})),J=l((()=>{if(g.value)return S.value?"text":"none"})),O=l((()=>!i.disabled&&!i.readonly)),R=l((()=>!(g.value&&S.value)&&i.readonly));function T(e){if("Enter"!==e.key)return;if(!U.value||!P.value)return void(U.value=!0);const o=e.target;M.value=F.isValid(o.value)?o.value:null}function z(e){e.preventDefault(),e.stopPropagation(),U.value&&g.value?S.value=!0:U.value=!0}function B(){c("cancel"),U.value=!1,S.value=!1}function G(e){c("save",e),U.value=!1}function K(e){null==e&&(M.value=null)}function _(){w(),g.value&&S.value&&!P.value&&(U.value=!1,S.value=!1)}return a(U,(e=>{e||(S.value=!1,E.value=["save"])})),C((()=>{const e=r.filterProps(i),o=m.filterProps(A(i,["active","location","rounded"])),l=v.filterProps(i);return t(v,n({ref:$},l,{class:i.class,style:i.style,modelValue:H.value,inputmode:J.value,readonly:R.value,onKeydown:O.value?T:void 0,focused:U.value||P.value,onFocus:x,onBlur:_,"onClick:control":O.value?z:void 0,"onClick:prepend":O.value?z:void 0,"onUpdate:modelValue":K}),{...f,default:()=>{var l;return t(u,null,[t(d,{modelValue:U.value,"onUpdate:modelValue":e=>U.value=e,activator:"parent","min-width":"0",eager:P.value,location:i.location,closeOnContentClick:!1,openOnClick:!1},{default:()=>[t(r,n(e,{modelValue:M.value,"onUpdate:modelValue":e=>M.value=e,disabled:E.value,onSave:G,onCancel:B}),{default:e=>{let{actions:l,model:a,save:u,cancel:r,isPristine:s}=e;return t(m,n(o,{modelValue:i.hideActions?M.value:a.value,"onUpdate:modelValue":e=>function(e){i.hideActions?(M.value=e,i.multiple||(U.value=!1)):a.value=e,c("save",e),E.value=[]}(e),onMousedown:e=>e.preventDefault()}),{actions:i.hideActions?void 0:()=>{var e;return(null==(e=f.actions)?void 0:e.call(f,{save:u,cancel:r,isPristine:s}))??l()}})}})]}),null==(l=f.default)?void 0:l.call(f)])}})})),j({},$)}});export{x as VDateInput,P as makeVDateInputProps};
