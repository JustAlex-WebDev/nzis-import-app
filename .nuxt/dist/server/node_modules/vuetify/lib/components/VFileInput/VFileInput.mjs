import{computed as e,ref as l,watch as o,createVNode as t,mergeProps as n,Fragment as u,nextTick as i}from"/Users/alexandarvalov/Documents/GitHub/nzis-import-app/node_modules/vue/index.mjs";/* empty css               */import{makeVFieldProps as r,VField as a}from"../VField/VField.mjs";import{makeVInputProps as s,VInput as p}from"../VInput/VInput.mjs";import{useFocus as c}from"../../composables/focus.mjs";import{forwardRefs as d}from"../../composables/forwardRefs.mjs";import{useLocale as v}from"../../composables/locale.mjs";import{useProxiedModel as m}from"../../composables/proxiedModel.mjs";import{humanReadableFileSize as f,wrapInArray as y,filterInputAttrs as h,callEvent as b}from"../../util/helpers.mjs";import{VCounter as V}from"../VCounter/VCounter.mjs";import{VChip as g}from"../VChip/VChip.mjs";import{genericComponent as j}from"../../util/defineComponent.mjs";import{propsFactory as I}from"../../util/propsFactory.mjs";import{useRender as C}from"../../util/useRender.mjs";const S=I({chips:Boolean,counter:Boolean,counterSizeString:{type:String,default:"$vuetify.fileInput.counterSize"},counterString:{type:String,default:"$vuetify.fileInput.counter"},hideInput:Boolean,multiple:Boolean,showSize:{type:[Boolean,Number,String],default:!1,validator:e=>"boolean"==typeof e||[1e3,1024].includes(Number(e))},...s({prependIcon:"$file"}),modelValue:{type:[Array,Object],default:e=>e.multiple?[]:null,validator:e=>y(e).every((e=>null!=e&&"object"==typeof e))},...r({clearable:!0})},"VFileInput"),k=j()({name:"VFileInput",inheritAttrs:!1,props:S(),emits:{"click:control":e=>!0,"mousedown:control":e=>!0,"update:focused":e=>!0,"update:modelValue":e=>!0},setup(r,s){let{attrs:j,emit:I,slots:S}=s;const{t:k}=v(),z=m(r,"modelValue",r.modelValue,(e=>y(e)),(e=>!r.multiple&&Array.isArray(e)?e[0]:e)),{isFocused:w,focus:B,blur:D}=c(r),F=e((()=>"boolean"!=typeof r.showSize?r.showSize:void 0)),A=e((()=>(z.value??[]).reduce(((e,l)=>{let{size:o=0}=l;return e+o}),0))),x=e((()=>f(A.value,F.value))),$=e((()=>(z.value??[]).map((e=>{const{name:l="",size:o=0}=e;return r.showSize?`${l} (${f(o,F.value)})`:l})))),P=e((()=>{var e;const l=(null==(e=z.value)?void 0:e.length)??0;return r.showSize?k(r.counterSizeString,l,x.value):k(r.counterString,l)})),R=l(),N=l(),M=l(),T=e((()=>w.value||r.active)),E=e((()=>["plain","underlined"].includes(r.variant)));function G(){var e;M.value!==(void 0).activeElement&&(null==(e=M.value)||e.focus()),w.value||B()}function H(e){var l;null==(l=M.value)||l.click()}function O(e){I("mousedown:control",e)}function U(e){var l;null==(l=M.value)||l.click(),I("click:control",e)}function _(e){e.stopPropagation(),G(),i((()=>{z.value=[],b(r["onClick:clear"],e)}))}function q(e){e.preventDefault()}function J(e){e.preventDefault(),e.dataTransfer&&(z.value=[...e.dataTransfer.files??[]])}return o(z,(e=>{(!Array.isArray(e)||!e.length)&&M.value&&(M.value.value="")})),C((()=>{const e=!(!S.counter&&!r.counter),l=!(!e&&!S.details),[o,i]=h(j),{modelValue:s,...c}=p.filterProps(r),d=a.filterProps(r);return t(p,n({ref:R,modelValue:r.multiple?z.value:z.value[0],class:["v-file-input",{"v-file-input--chips":!!r.chips,"v-file-input--hide":r.hideInput,"v-input--plain-underlined":E.value},r.class],style:r.style,"onClick:prepend":H},o,c,{centerAffix:!E.value,focused:w.value}),{...S,default:e=>{let{id:l,isDisabled:o,isDirty:s,isReadonly:p,isValid:c}=e;return t(a,n({ref:N,"prepend-icon":r.prependIcon,onMousedown:O,onClick:U,"onClick:clear":_,"onClick:prependInner":r["onClick:prependInner"],"onClick:appendInner":r["onClick:appendInner"]},d,{id:l.value,active:T.value||s.value,dirty:s.value||r.dirty,disabled:o.value,focused:w.value,error:!1===c.value,onDragover:q,onDrop:J}),{...S,default:e=>{var l;let{props:{class:a,...s}}=e;return t(u,null,[t("input",n({ref:M,type:"file",readonly:p.value,disabled:o.value,multiple:r.multiple,name:r.name,onClick:e=>{e.stopPropagation(),p.value&&e.preventDefault(),G()},onChange:e=>{if(!e.target)return;const l=e.target;z.value=[...l.files??[]]},onFocus:G,onBlur:D},s,i),null),t("div",{class:a},[!!(null==(l=z.value)?void 0:l.length)&&!r.hideInput&&(S.selection?S.selection({fileNames:$.value,totalBytes:A.value,totalBytesReadable:x.value}):r.chips?$.value.map((e=>t(g,{key:e,size:"small",text:e},null))):$.value.join(", "))])])}})},details:l?l=>{var o,n;return t(u,null,[null==(o=S.details)?void 0:o.call(S,l),e&&t(u,null,[t("span",null,null),t(V,{active:!!(null==(n=z.value)?void 0:n.length),value:P.value,disabled:r.disabled},S.counter)])])}:void 0})})),d({},R,N,M)}});export{k as VFileInput,S as makeVFileInputProps};
