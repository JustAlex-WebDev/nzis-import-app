import{computed as e,ref as t,shallowRef as o,watchEffect as l,watch as r,nextTick as a,createVNode as n,mergeProps as u,Fragment as i,withDirectives as s,resolveDirective as d,vModelText as c}from"/Users/alexandarvalov/Documents/GitHub/nzis-import-app/node_modules/vue/index.mjs";/* empty css              *//* empty css                           */import{VCounter as p}from"../VCounter/VCounter.mjs";import{makeVFieldProps as f,VField as v}from"../VField/VField.mjs";import{makeVInputProps as m,VInput as x}from"../VInput/VInput.mjs";import{useFocus as g}from"../../composables/focus.mjs";import{forwardRefs as V}from"../../composables/forwardRefs.mjs";import{useProxiedModel as w}from"../../composables/proxiedModel.mjs";import{Intersect as y}from"../../directives/intersect/index.mjs";import{genericComponent as b}from"../../util/defineComponent.mjs";import{propsFactory as h}from"../../util/propsFactory.mjs";import{useRender as F}from"../../util/useRender.mjs";import{convertToUnit as j,clamp as C,filterInputAttrs as S,callEvent as k}from"../../util/helpers.mjs";const N=h({autoGrow:Boolean,autofocus:Boolean,counter:[Boolean,Number,String],counterValue:Function,prefix:String,placeholder:String,persistentPlaceholder:Boolean,persistentCounter:Boolean,noResize:Boolean,rows:{type:[Number,String],default:5,validator:e=>!isNaN(parseFloat(e))},maxRows:{type:[Number,String],validator:e=>!isNaN(parseFloat(e))},suffix:String,modelModifiers:Object,...m(),...f()},"VTextarea"),P=b()({name:"VTextarea",directives:{Intersect:y},inheritAttrs:!1,props:N(),emits:{"click:control":e=>!0,"mousedown:control":e=>!0,"update:focused":e=>!0,"update:modelValue":e=>!0},setup(f,m){let{attrs:y,emit:b,slots:h}=m;const N=w(f,"modelValue"),{isFocused:P,focus:R,blur:I}=g(f),z=e((()=>"function"==typeof f.counterValue?f.counterValue(N.value):(N.value||"").toString().length)),B=e((()=>y.maxlength?y.maxlength:!f.counter||"number"!=typeof f.counter&&"string"!=typeof f.counter?void 0:f.counter));function G(e,t){var o,l;f.autofocus&&e&&(null==(l=null==(o=t[0].target)?void 0:o.focus)||l.call(o))}const _=t(),M=t(),T=o(""),A=t(),D=e((()=>f.persistentPlaceholder||P.value||f.active));function E(){var e;A.value!==(void 0).activeElement&&(null==(e=A.value)||e.focus()),P.value||R()}function H(e){E(),b("click:control",e)}function U(e){b("mousedown:control",e)}function O(e){e.stopPropagation(),E(),a((()=>{N.value="",k(f["onClick:clear"],e)}))}function $(e){var t;const o=e.target;if(N.value=o.value,null==(t=f.modelModifiers)?void 0:t.trim){const e=[o.selectionStart,o.selectionEnd];a((()=>{o.selectionStart=e[0],o.selectionEnd=e[1]}))}}const q=t(),J=t(Number(f.rows)),K=e((()=>["plain","underlined"].includes(f.variant)));function L(){f.autoGrow&&a((()=>{if(!q.value||!M.value)return;const e=getComputedStyle(q.value),t=getComputedStyle(M.value.$el),o=parseFloat(e.getPropertyValue("--v-field-padding-top"))+parseFloat(e.getPropertyValue("--v-input-padding-top"))+parseFloat(e.getPropertyValue("--v-field-padding-bottom")),l=q.value.scrollHeight,r=parseFloat(e.lineHeight),a=Math.max(parseFloat(f.rows)*r+o,parseFloat(t.getPropertyValue("--v-input-control-height"))),n=parseFloat(f.maxRows)*r+o||1/0,u=C(l??0,a,n);J.value=Math.floor((u-o)/r),T.value=j(u)}))}let Q;return l((()=>{f.autoGrow||(J.value=Number(f.rows))})),r(N,L),r((()=>f.rows),L),r((()=>f.maxRows),L),r((()=>f.density),L),r(q,(e=>{e?(Q=new ResizeObserver(L),Q.observe(q.value)):null==Q||Q.disconnect()})),F((()=>{const e=!!(h.counter||f.counter||f.counterValue),t=!(!e&&!h.details),[o,l]=S(y),{modelValue:r,...a}=x.filterProps(f),m=v.filterProps(f);return n(x,u({ref:_,modelValue:N.value,"onUpdate:modelValue":e=>N.value=e,class:["v-textarea v-text-field",{"v-textarea--prefixed":f.prefix,"v-textarea--suffixed":f.suffix,"v-text-field--prefixed":f.prefix,"v-text-field--suffixed":f.suffix,"v-textarea--auto-grow":f.autoGrow,"v-textarea--no-resize":f.noResize||f.autoGrow,"v-input--plain-underlined":K.value},f.class],style:f.style},o,a,{centerAffix:1===J.value&&!K.value,focused:P.value}),{...h,default:e=>{let{id:t,isDisabled:o,isDirty:r,isReadonly:a,isValid:p}=e;return n(v,u({ref:M,style:{"--v-textarea-control-height":T.value},onClick:H,onMousedown:U,"onClick:clear":O,"onClick:prependInner":f["onClick:prependInner"],"onClick:appendInner":f["onClick:appendInner"]},m,{id:t.value,active:D.value||r.value,centerAffix:1===J.value&&!K.value,dirty:r.value||f.dirty,disabled:o.value,focused:P.value,error:!1===p.value}),{...h,default:e=>{let{props:{class:t,...r}}=e;return n(i,null,[f.prefix&&n("span",{class:"v-text-field__prefix"},[f.prefix]),s(n("textarea",u({ref:A,class:t,value:N.value,onInput:$,autofocus:f.autofocus,readonly:a.value,disabled:o.value,placeholder:f.placeholder,rows:f.rows,name:f.name,onFocus:E,onBlur:I},r,l),null),[[d("intersect"),{handler:G},null,{once:!0}]]),f.autoGrow&&s(n("textarea",{class:[t,"v-textarea__sizer"],id:`${r.id}-sizer`,"onUpdate:modelValue":e=>N.value=e,ref:q,readonly:!0,"aria-hidden":"true"},null),[[c,N.value]]),f.suffix&&n("span",{class:"v-text-field__suffix"},[f.suffix])])}})},details:t?t=>{var o;return n(i,null,[null==(o=h.details)?void 0:o.call(h,t),e&&n(i,null,[n("span",null,null),n(p,{active:f.persistentCounter||P.value,value:z.value,max:B.value,disabled:f.disabled},h.counter)])])}:void 0})})),V({},_,M,A)}});export{P as VTextarea,N as makeVTextareaProps};
