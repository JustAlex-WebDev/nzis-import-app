import{useProxiedModel as e}from"../../../composables/proxiedModel.mjs";import{computed as l,shallowRef as t,provide as a,inject as u}from"/Users/alexandarvalov/Documents/GitHub/nzis-import-app/node_modules/vue/index.mjs";import{propsFactory as s}from"../../../util/propsFactory.mjs";import{wrapInArray as r,deepEqual as c}from"../../../util/helpers.mjs";const n={showSelectAll:!1,allSelected:()=>[],select:e=>{var l;let{items:t,value:a}=e;return new Set(a?[null==(l=t[0])?void 0:l.value]:[])},selectAll:e=>{let{selected:l}=e;return l}},o={showSelectAll:!0,allSelected:e=>{let{currentPage:l}=e;return l},select:e=>{let{items:l,value:t,selected:a}=e;for(const u of l)t?a.add(u.value):a.delete(u.value);return a},selectAll:e=>{let{value:l,currentPage:t,selected:a}=e;return o.select({items:t,value:l,selected:a})}},v={showSelectAll:!0,allSelected:e=>{let{allItems:l}=e;return l},select:e=>{let{items:l,value:t,selected:a}=e;for(const u of l)t?a.add(u.value):a.delete(u.value);return a},selectAll:e=>{let{value:l,allItems:t,selected:a}=e;return v.select({items:t,value:l,selected:a})}},i=s({showSelect:Boolean,selectStrategy:{type:[String,Object],default:"page"},modelValue:{type:Array,default:()=>[]},valueComparator:{type:Function,default:c}},"DataTable-select"),d=Symbol.for("vuetify:data-table-selection");function m(u,s){let{allItems:c,currentPage:i}=s;const m=e(u,"modelValue",u.modelValue,(e=>new Set(r(e).map((e=>{var l;return(null==(l=c.value.find((l=>u.valueComparator(e,l.value))))?void 0:l.value)??e})))),(e=>[...e.values()])),f=l((()=>c.value.filter((e=>e.selectable)))),S=l((()=>i.value.filter((e=>e.selectable)))),p=l((()=>{if("object"==typeof u.selectStrategy)return u.selectStrategy;switch(u.selectStrategy){case"single":return n;case"all":return v;default:return o}})),g=t(null);function y(e){return r(e).every((e=>m.value.has(e.value)))}function h(e,l){const t=p.value.select({items:e,value:l,selected:new Set(m.value)});m.value=t}const w=l((()=>m.value.size>0)),A=l((()=>{const e=p.value.allSelected({allItems:f.value,currentPage:S.value});return!!e.length&&y(e)})),b={toggleSelect:function(e,l,t){const a=[];if(l=l??i.value.findIndex((l=>l.value===e.value)),"single"!==u.selectStrategy&&(null==t?void 0:t.shiftKey)&&null!==g.value){const[e,t]=[g.value,l].sort(((e,l)=>e-l));a.push(...i.value.slice(e,t+1))}else a.push(e),g.value=l;h(a,!y([e]))},select:h,selectAll:function(e){const l=p.value.selectAll({value:e,allItems:f.value,currentPage:S.value,selected:new Set(m.value)});m.value=l},isSelected:y,isSomeSelected:function(e){return r(e).some((e=>m.value.has(e.value)))},someSelected:w,allSelected:A,showSelectAll:l((()=>p.value.showSelectAll)),lastSelectedIndex:g,selectStrategy:p};return a(d,b),b}function f(){const e=u(d);if(!e)throw new Error("Missing selection!");return e}export{d as VDataTableSelectionSymbol,i as makeDataTableSelectProps,m as provideSelection,f as useSelection};
