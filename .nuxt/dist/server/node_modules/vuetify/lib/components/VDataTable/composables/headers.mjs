import{ref as e,watchEffect as t,capitalize as n,provide as l,inject as o}from"/Users/alexandarvalov/Documents/GitHub/nzis-import-app/node_modules/vue/index.mjs";import{propsFactory as r}from"../../../util/propsFactory.mjs";import{consoleError as i}from"../../../util/console.mjs";const a=r({headers:Array},"DataTable-header"),s=Symbol.for("vuetify:data-table-headers"),u={title:"",sortable:!1},d={...u,width:48};function c(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(e.children)for(const n of e.children)c(n,t);else t.push(e);return t}function h(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Set;for(const n of e)n.key&&t.add(n.key),n.children&&h(n.children,t);return t}function f(e){if(e.key)return"data-table-group"===e.key?u:["data-table-expand","data-table-select"].includes(e.key)?d:void 0}function p(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e.children?Math.max(t,...e.children.map((e=>p(e,t+1)))):t}function m(e,t){const n=[];let l=0;const o=function(){const e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).map((e=>({element:e,priority:0})));return{enqueue:(t,n)=>{let l=!1;for(let o=0;o<e.length;o++)if(e[o].priority>n){e.splice(o,0,{element:t,priority:n}),l=!0;break}l||e.push({element:t,priority:n})},size:()=>e.length,count:()=>{let t=0;if(!e.length)return 0;const n=Math.floor(e[0].priority);for(let l=0;l<e.length;l++)Math.floor(e[l].priority)===n&&(t+=1);return t},dequeue:()=>e.shift()}}(e);for(;o.size()>0;){let e=o.count();const r=[];let i=1;for(;e>0;){const{element:n,priority:a}=o.dequeue(),s=t-l-p(n);if(r.push({...n,rowspan:s??1,colspan:n.children?c(n).length:1}),n.children)for(const e of n.children){const t=a%1+i/Math.pow(10,l+2);o.enqueue(e,l+s+t)}i+=1,e-=1}l+=1,n.push(r)}return{columns:e.map((e=>c(e))).flat(),headers:n}}function v(e){const t=[];for(const n of e){const e={...f(n),...n},l=e.key??("string"==typeof e.value?e.value:null),o=e.value??l??null,r={...e,key:l,value:o,sortable:e.sortable??(null!=e.key||!!e.sort),children:e.children?v(e.children):void 0};t.push(r)}return t}function y(o,r){const a=e([]),u=e([]),d=e({}),c=e({}),f=e({});t((()=>{var e,t,l;const s=(o.headers||Object.keys(o.items[0]??{}).map((e=>({key:e,title:n(e)})))).slice(),y=h(s);(null==(e=null==r?void 0:r.groupBy)?void 0:e.value.length)&&!y.has("data-table-group")&&s.unshift({key:"data-table-group",title:"Group"}),(null==(t=null==r?void 0:r.showSelect)?void 0:t.value)&&!y.has("data-table-select")&&s.unshift({key:"data-table-select"}),(null==(l=null==r?void 0:r.showExpand)?void 0:l.value)&&!y.has("data-table-expand")&&s.push({key:"data-table-expand"});const b=v(s);!function(e){let t=!1;function n(e){if(e)if(arguments.length>1&&void 0!==arguments[1]&&arguments[1]&&(e.fixed=!0),e.fixed)if(e.children)for(let t=e.children.length-1;t>=0;t--)n(e.children[t],!0);else t?isNaN(Number(e.width))?i(`Multiple fixed columns should have a static width (key: ${e.key})`):e.minWidth=Math.max(Number(e.width)||0,Number(e.minWidth)||0):e.lastFixed=!0,t=!0;else if(e.children)for(let t=e.children.length-1;t>=0;t--)n(e.children[t]);else t=!1}for(let r=e.length-1;r>=0;r--)n(e[r]);function l(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(!e)return t;if(e.children){e.fixedOffset=t;for(const n of e.children)t=l(n,t)}else e.fixed&&(e.fixedOffset=t,t+=parseFloat(e.width||"0")||0);return t}let o=0;for(const r of e)o=l(r,o)}(b);const g=Math.max(...b.map((e=>p(e))))+1,k=m(b,g);a.value=k.headers,u.value=k.columns;const x=k.headers.flat(1);for(const n of x)n.key&&(n.sortable&&(n.sort&&(d.value[n.key]=n.sort),n.sortRaw&&(c.value[n.key]=n.sortRaw)),n.filter&&(f.value[n.key]=n.filter))}));const y={headers:a,columns:u,sortFunctions:d,sortRawFunctions:c,filterFunctions:f};return l(s,y),y}function b(){const e=o(s);if(!e)throw new Error("Missing headers!");return e}export{s as VDataTableHeadersSymbol,y as createHeaders,a as makeDataTableHeaderProps,b as useHeaders};
