import{toRefs as e,toRef as t,computed as l,shallowRef as o,createVNode as a,mergeProps as r}from"/Users/alexandarvalov/Documents/GitHub/nzis-import-app/node_modules/vue/index.mjs";import{makeDataTableProps as s}from"./VDataTable.mjs";import{VDataTableHeaders as m}from"./VDataTableHeaders.mjs";import{VDataTableRow as i}from"./VDataTableRow.mjs";import{VDataTableRows as n}from"./VDataTableRows.mjs";import{VVirtualScrollItem as d}from"../VVirtualScroll/VVirtualScrollItem.mjs";import{provideExpanded as p}from"./composables/expand.mjs";import{createGroupBy as u,provideGroupBy as c,useGroupedItems as f,makeDataTableGroupProps as v}from"./composables/group.mjs";import{createHeaders as g}from"./composables/headers.mjs";import{useDataTableItems as b}from"./composables/items.mjs";import{useOptions as h}from"./composables/options.mjs";import{provideSelection as y}from"./composables/select.mjs";import{createSort as x,provideSort as S,useSortedItems as j}from"./composables/sort.mjs";import{provideDefaults as V}from"../../composables/defaults.mjs";import{useFilter as I,makeFilterProps as T}from"../../composables/filter.mjs";import{useVirtual as w,makeVirtualProps as D}from"../../composables/virtual.mjs";import{VTable as B}from"../VTable/VTable.mjs";import{genericComponent as R}from"../../util/defineComponent.mjs";import{propsFactory as F}from"../../util/propsFactory.mjs";import{useRender as P}from"../../util/useRender.mjs";import{omit as k,convertToUnit as E}from"../../util/helpers.mjs";const G=F({...k(s(),["hideDefaultFooter"]),...v(),...D(),...T()},"VDataTableVirtual"),H=R()({name:"VDataTableVirtual",props:G(),emits:{"update:modelValue":e=>!0,"update:sortBy":e=>!0,"update:options":e=>!0,"update:groupBy":e=>!0,"update:expanded":e=>!0},setup(s,v){let{attrs:T,slots:D}=v;const{groupBy:R}=u(s),{sortBy:F,multiSort:k,mustSort:G}=x(s),{disableSort:H}=e(s),{columns:_,headers:z,filterFunctions:A,sortFunctions:N,sortRawFunctions:O}=g(s,{groupBy:R,showSelect:t(s,"showSelect"),showExpand:t(s,"showExpand")}),{items:U}=b(s,_),C=t(s,"search"),{filteredItems:K}=I(s,U,C,{transform:e=>e.columns,customKeyFilter:A}),{toggleSort:W}=S({sortBy:F,multiSort:k,mustSort:G}),{sortByWithGroups:q,opened:J,extractRows:L,isGroupOpen:M,toggleGroup:Q}=c({groupBy:R,sortBy:F,disableSort:H}),{sortedItems:X}=j(s,K,q,{transform:e=>({...e.raw,...e.columns}),sortFunctions:N,sortRawFunctions:O}),{flatItems:Y}=f(X,R,J),Z=l((()=>L(Y.value))),{isSelected:$,select:ee,selectAll:te,toggleSelect:le,someSelected:oe,allSelected:ae}=y(s,{allItems:Z,currentPage:Z}),{isExpanded:re,toggleExpand:se}=p(s),{containerRef:me,markerRef:ie,paddingTop:ne,paddingBottom:de,computedItems:pe,handleItemResize:ue,handleScroll:ce,handleScrollend:fe,calculateVisibleItems:ve,scrollToIndex:ge}=w(s,Y),be=l((()=>pe.value.map((e=>e.raw))));h({sortBy:F,page:o(1),itemsPerPage:o(-1),groupBy:R,search:C}),V({VDataTableRows:{hideNoData:t(s,"hideNoData"),noDataText:t(s,"noDataText"),loading:t(s,"loading"),loadingText:t(s,"loadingText")}});const he=l((()=>({sortBy:F.value,toggleSort:W,someSelected:oe.value,allSelected:ae.value,isSelected:$,select:ee,selectAll:te,toggleSelect:le,isExpanded:re,toggleExpand:se,isGroupOpen:M,toggleGroup:Q,items:Z.value.map((e=>e.raw)),internalItems:Z.value,groupedItems:Y.value,columns:_.value,headers:z.value})));return P((()=>{const e=m.filterProps(s),t=n.filterProps(s),l=B.filterProps(s);return a(B,r({class:["v-data-table",{"v-data-table--loading":s.loading},s.class],style:s.style},l,{fixedHeader:s.fixedHeader||s.sticky}),{top:()=>{var e;return null==(e=D.top)?void 0:e.call(D,he.value)},wrapper:()=>{var l,o,p,u,c,f;return a("div",{ref:me,onScrollPassive:ce,onScrollend:fe,class:"v-table__wrapper",style:{height:E(s.height)}},[a("table",null,[null==(l=D.colgroup)?void 0:l.call(D,he.value),!s.hideDefaultHeader&&a("thead",{key:"thead"},[a(m,e,D)]),null==(o=D.thead)?void 0:o.call(D,he.value),!s.hideDefaultBody&&a("tbody",{key:"tbody"},[a("tr",{ref:ie,style:{height:E(ne.value),border:0}},[a("td",{colspan:_.value.length,style:{height:0,border:0}},null)]),null==(p=D["body.prepend"])?void 0:p.call(D,he.value),a(n,r(T,t,{items:be.value}),{...D,item:e=>a(d,{key:e.internalItem.index,renderless:!0,"onUpdate:height":t=>ue(e.internalItem.index,t)},{default:t=>{var l;let{itemRef:o}=t;return(null==(l=D.item)?void 0:l.call(D,{...e,itemRef:o}))??a(i,r(e.props,{ref:o,key:e.internalItem.index,index:e.internalItem.index}),D)}})}),null==(u=D["body.append"])?void 0:u.call(D,he.value),a("tr",{style:{height:E(de.value),border:0}},[a("td",{colspan:_.value.length,style:{height:0,border:0}},null)])]),null==(c=D.tbody)?void 0:c.call(D,he.value),null==(f=D.tfoot)?void 0:f.call(D,he.value)])])},bottom:()=>{var e;return null==(e=D.bottom)?void 0:e.call(D,he.value)}})})),{calculateVisibleItems:ve,scrollToIndex:ge}}});export{H as VDataTableVirtual,G as makeVDataTableVirtualProps};
