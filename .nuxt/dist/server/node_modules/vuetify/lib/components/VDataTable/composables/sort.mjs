import{useProxiedModel as t}from"../../../composables/proxiedModel.mjs";import{toRef as o,provide as r,computed as e,inject as n}from"/Users/alexandarvalov/Documents/GitHub/nzis-import-app/node_modules/vue/index.mjs";import{useLocale as s}from"../../../composables/locale.mjs";import{getObjectValueByPath as u,isEmpty as l}from"../../../util/helpers.mjs";import{propsFactory as i}from"../../../util/propsFactory.mjs";const a=i({sortBy:{type:Array,default:()=>[]},customKeySort:Object,multiSort:Boolean,mustSort:Boolean},"DataTable-sort"),c=Symbol.for("vuetify:data-table-sort");function m(r){return{sortBy:t(r,"sortBy"),mustSort:o(r,"mustSort"),multiSort:o(r,"multiSort")}}function f(t){const{sortBy:o,mustSort:e,multiSort:n,page:s}=t;const u={sortBy:o,toggleSort:t=>{if(null==t.key)return;let r=o.value.map((t=>({...t})))??[];const u=r.find((o=>o.key===t.key));u?"desc"===u.order?e.value&&1===r.length?u.order="asc":r=r.filter((o=>o.key!==t.key)):u.order="desc":n.value?r.push({key:t.key,order:"asc"}):r=[{key:t.key,order:"asc"}],o.value=r,s&&(s.value=1)},isSorted:function(t){return!!o.value.find((o=>o.key===t.key))}};return r(c,u),u}function d(){const t=n(c);if(!t)throw new Error("Missing sort!");return t}function v(t,o,r,n){const u=s();return{sortedItems:e((()=>{var e,s;return r.value.length?y(o.value,r.value,u.current.value,{transform:null==n?void 0:n.transform,sortFunctions:{...t.customKeySort,...null==(e=null==n?void 0:n.sortFunctions)?void 0:e.value},sortRawFunctions:null==(s=null==n?void 0:n.sortRawFunctions)?void 0:s.value}):o.value}))}}function y(t,o,r,e){const n=new Intl.Collator(r,{sensitivity:"accent",usage:"sort"});return t.map((t=>[t,(null==e?void 0:e.transform)?e.transform(t):t])).sort(((t,r)=>{var s,i;for(let a=0;a<o.length;a++){let c=!1;const m=o[a].key,f=o[a].order??"asc";if(!1===f)continue;let d=u(t[1],m),v=u(r[1],m),y=t[0].raw,p=r[0].raw;if("desc"===f&&([d,v]=[v,d],[y,p]=[p,y]),null==(s=null==e?void 0:e.sortRawFunctions)?void 0:s[m]){const t=e.sortRawFunctions[m](y,p);if(null==t)continue;if(c=!0,t)return t}if(null==(i=null==e?void 0:e.sortFunctions)?void 0:i[m]){const t=e.sortFunctions[m](d,v);if(null==t)continue;if(c=!0,t)return t}if(!c){if(d instanceof Date&&v instanceof Date)return d.getTime()-v.getTime();if([d,v]=[d,v].map((t=>null!=t?t.toString().toLocaleLowerCase():t)),d!==v)return l(d)&&l(v)?0:l(d)?-1:l(v)?1:isNaN(d)||isNaN(v)?n.compare(d,v):Number(d)-Number(v)}}return 0})).map((t=>{let[o]=t;return o}))}export{m as createSort,a as makeDataTableSortProps,f as provideSort,y as sortItems,d as useSort,v as useSortedItems};
