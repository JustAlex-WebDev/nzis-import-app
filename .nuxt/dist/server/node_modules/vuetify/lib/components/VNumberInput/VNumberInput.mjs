import{ref as e,computed as n,shallowRef as l,watchEffect as t,watch as u,createVNode as r,Fragment as a,mergeProps as i,nextTick as o}from"/Users/alexandarvalov/Documents/GitHub/nzis-import-app/node_modules/vue/index.mjs";/* empty css                 */import{makeVTextFieldProps as s,VTextField as v}from"../VTextField/VTextField.mjs";import{useHold as d}from"./hold.mjs";import{useFocus as p}from"../../composables/focus.mjs";import{useForm as m}from"../../composables/form.mjs";import{forwardRefs as c}from"../../composables/forwardRefs.mjs";import{useProxiedModel as f}from"../../composables/proxiedModel.mjs";import{VDivider as b}from"../VDivider/VDivider.mjs";import{VBtn as N}from"../VBtn/VBtn.mjs";import{VDefaultsProvider as g}from"../VDefaultsProvider/VDefaultsProvider.mjs";import{genericComponent as h}from"../../util/defineComponent.mjs";import{propsFactory as V}from"../../util/propsFactory.mjs";import{useRender as y}from"../../util/useRender.mjs";import{omit as x,clamp as w}from"../../util/helpers.mjs";const P=V({controlVariant:{type:String,default:"default"},inset:Boolean,hideInput:Boolean,modelValue:{type:Number,default:null},min:{type:Number,default:Number.MIN_SAFE_INTEGER},max:{type:Number,default:Number.MAX_SAFE_INTEGER},step:{type:Number,default:1},precision:{type:Number,default:0},...x(s(),["modelValue","validationValue"])},"VNumberInput"),k=h()({name:"VNumberInput",props:{...P()},emits:{"update:modelValue":e=>!0},setup(s,h){let{slots:V}=h;const x=e(),{holdStart:P,holdStop:k}=d({toggleUpDown:L}),D=m(s),j=n((()=>D.isDisabled.value||D.isReadonly.value)),{isFocused:I,focus:S,blur:_}=p(s);function A(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:s.precision;const l=null==n?String(e):e.toFixed(n);return I.value?Number(l).toString():l}const B=f(s,"modelValue",null,(e=>e??null),(e=>null==e?e??null:w(Number(e),s.min,s.max))),F=l(null);t((()=>{I.value&&!j.value||(null==B.value?F.value=null:isNaN(B.value)||(F.value=A(B.value)))}));const C=n({get:()=>F.value,set(e){null===e||""===e?(B.value=null,F.value=null):!isNaN(Number(e))&&Number(e)<=s.max&&Number(e)>=s.min&&(B.value=Number(e),F.value=e)}}),E=n((()=>!j.value&&(B.value??0)+s.step<=s.max)),T=n((()=>!j.value&&(B.value??0)-s.step>=s.min)),R=n((()=>s.hideInput?"stacked":s.controlVariant)),z=n((()=>"split"===R.value?"$plus":"$collapse")),M=n((()=>"split"===R.value?"$minus":"$expand")),$=n((()=>"split"===R.value?"default":"small")),U=n((()=>"stacked"===R.value?"auto":"100%")),G=n((()=>({props:{onClick:q,onPointerup:J,onPointerdown:Q}}))),K=n((()=>({props:{onClick:q,onPointerup:J,onPointerdown:W}})));function H(e){if(null==e)return 0;const n=e.toString(),l=n.indexOf(".");return~l?n.length-l:0}function L(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(j.value)return;if(null==B.value)return void(C.value=A(w(0,s.min,s.max)));let n=Math.max(H(B.value),H(s.step));null!=s.precision&&(n=Math.max(n,s.precision)),e?E.value&&(C.value=A(B.value+s.step,n)):T.value&&(C.value=A(B.value-s.step,n))}function O(e){var n,l,t,u;if(!e.data)return;const r=null==(n=e.target)?void 0:n.value,a=null==(l=e.target)?void 0:l.selectionStart,i=null==(t=e.target)?void 0:t.selectionEnd,o=r?r.slice(0,a)+e.data+r.slice(i):e.data;/^-?(\d+(\.\d*)?|(\.\d+)|\d*|\.)$/.test(o)||e.preventDefault(),null!=s.precision&&((null==(u=o.split(".")[1])?void 0:u.length)>s.precision&&e.preventDefault(),0===s.precision&&o.includes(".")&&e.preventDefault())}async function X(e){["Enter","ArrowLeft","ArrowRight","Backspace","Delete","Tab"].includes(e.key)||e.ctrlKey||["ArrowDown","ArrowUp"].includes(e.key)&&(e.preventDefault(),Y(),await o(),"ArrowDown"===e.key?L(!1):L())}function q(e){e.stopPropagation()}function J(e){const n=e.currentTarget;null==n||n.releasePointerCapture(e.pointerId),e.preventDefault(),e.stopPropagation(),k()}function Q(e){const n=e.currentTarget;null==n||n.setPointerCapture(e.pointerId),e.preventDefault(),e.stopPropagation(),P("up")}function W(e){const n=e.currentTarget;null==n||n.setPointerCapture(e.pointerId),e.preventDefault(),e.stopPropagation(),P("down")}function Y(){if(j.value)return;if(!x.value)return;const e=x.value.value;e&&!isNaN(Number(e))?C.value=A(w(Number(e),s.min,s.max)):C.value=null}function Z(){S(),j.value||(null===B.value||isNaN(B.value)?C.value=null:C.value=B.value.toString())}function ee(){_(),Y()}return u((()=>s.precision),(()=>function(){if(j.value)return;if(null===B.value||isNaN(B.value))return void(C.value=null);C.value=null==s.precision?String(B.value):B.value.toFixed(s.precision)}())),y((()=>{const{modelValue:e,...n}=v.filterProps(s);function l(){return V.increment?r(g,{key:"increment-defaults",defaults:{VBtn:{disabled:!E.value,flat:!0,height:U.value,size:$.value,icon:z.value}}},{default:()=>[V.increment(G.value)]}):r(N,{disabled:!E.value,flat:!0,key:"increment-btn",height:U.value,"data-testid":"increment","aria-hidden":"true",icon:z.value,onClick:q,onPointerup:J,onPointerdown:Q,size:$.value,tabindex:"-1"},null)}function t(){return V.decrement?r(g,{key:"decrement-defaults",defaults:{VBtn:{disabled:!T.value,flat:!0,height:U.value,size:$.value,icon:M.value}}},{default:()=>[V.decrement(K.value)]}):r(N,{disabled:!T.value,flat:!0,key:"decrement-btn",height:U.value,"data-testid":"decrement","aria-hidden":"true",icon:M.value,size:$.value,tabindex:"-1",onClick:q,onPointerup:J,onPointerdown:W},null)}function u(){return r("div",{class:"v-number-input__control"},[t(),r(b,{vertical:"stacked"!==R.value},null),l()])}function o(){return s.hideInput||s.inset?void 0:r(b,{vertical:!0},null)}const d="split"===R.value?r("div",{class:"v-number-input__control"},[r(b,{vertical:!0},null),l()]):s.reverse||"hidden"===R.value?void 0:r(a,null,[o(),u()]),p=V["append-inner"]||d,m="split"===R.value?r("div",{class:"v-number-input__control"},[t(),r(b,{vertical:!0},null)]):s.reverse&&"hidden"!==R.value?r(a,null,[u(),o()]):void 0,c=V["prepend-inner"]||m;return r(v,i({ref:x,modelValue:C.value,"onUpdate:modelValue":e=>C.value=e,validationValue:B.value,onBeforeinput:O,onFocus:Z,onBlur:ee,onKeydown:X,class:["v-number-input",{"v-number-input--default":"default"===R.value,"v-number-input--hide-input":s.hideInput,"v-number-input--inset":s.inset,"v-number-input--reverse":s.reverse,"v-number-input--split":"split"===R.value,"v-number-input--stacked":"stacked"===R.value},s.class]},n,{style:s.style,inputmode:"decimal"}),{...V,"append-inner":p?function(){for(var e,n=arguments.length,l=new Array(n),t=0;t<n;t++)l[t]=arguments[t];return r(a,null,[null==(e=V["append-inner"])?void 0:e.call(V,...l),d])}:void 0,"prepend-inner":c?function(){for(var e,n=arguments.length,l=new Array(n),t=0;t<n;t++)l[t]=arguments[t];return r(a,null,[m,null==(e=V["prepend-inner"])?void 0:e.call(V,...l)])}:void 0})})),c({},x)}});export{k as VNumberInput};
