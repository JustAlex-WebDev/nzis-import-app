import{VMenuSymbol as e}from"../VMenu/shared.mjs";import{useDelay as o,makeDelayProps as t}from"../../composables/delay.mjs";import{ref as n,computed as r,inject as a,watch as l,watchEffect as u,nextTick as v,onScopeDispose as i}from"/Users/alexandarvalov/Documents/GitHub/nzis-import-app/node_modules/vue/index.mjs";import{propsFactory as s}from"../../util/propsFactory.mjs";import{getCurrentInstance as c}from"../../util/getCurrentInstance.mjs";import{templateRef as p,matchesSelector as m}from"../../util/helpers.mjs";const d=s({target:[String,Object],activator:[String,Object],activatorProps:{type:Object,default:()=>({})},openOnClick:{type:Boolean,default:void 0},openOnHover:Boolean,openOnFocus:{type:Boolean,default:void 0},closeOnContentClick:Boolean,...t()},"VOverlay-activator");function O(t,s){let{isActive:d,isTop:O,contentEl:f}=s;const g=c("useActivator"),y=n();let C=!1,H=!1,j=!0;const E=r((()=>t.openOnFocus||null==t.openOnFocus&&t.openOnHover)),b=r((()=>t.openOnClick||null==t.openOnClick&&!t.openOnHover&&!E.value)),{runOpenDelay:k,runCloseDelay:F}=o(t,(e=>{e!==(t.openOnHover&&C||E.value&&H)||t.openOnHover&&d.value&&!O.value||(d.value!==e&&(j=!0),d.value=e)})),M=n(),h=e=>{e.stopPropagation(),y.value=e.currentTarget||e.target,d.value||(M.value=[e.clientX,e.clientY]),d.value=!d.value},T=e=>{var o;(null==(o=e.sourceCapabilities)?void 0:o.firesTouchEvents)||(C=!0,y.value=e.currentTarget||e.target,k())},A=e=>{C=!1,F()},B=e=>{!1!==m(e.target)&&(H=!0,e.stopPropagation(),y.value=e.currentTarget||e.target,k())},P=e=>{H=!1,e.stopPropagation(),F()},x=r((()=>{const e={};return b.value&&(e.onClick=h),t.openOnHover&&(e.onMouseenter=T,e.onMouseleave=A),E.value&&(e.onFocus=B,e.onBlur=P),e})),D=r((()=>{const o={};if(t.openOnHover&&(o.onMouseenter=()=>{C=!0,k()},o.onMouseleave=()=>{C=!1,F()}),E.value&&(o.onFocusin=()=>{H=!0,k()},o.onFocusout=()=>{H=!1,F()}),t.closeOnContentClick){const t=a(e,null);o.onClick=()=>{d.value=!1,null==t||t.closeParents()}}return o})),S=r((()=>{const e={};return t.openOnHover&&(e.onMouseenter=()=>{j&&(C=!0,j=!1,k())},e.onMouseleave=()=>{C=!1,F()}),e}));l(O,(e=>{var o;!e||(!t.openOnHover||C||E.value&&H)&&(!E.value||H||t.openOnHover&&C)||(null==(o=f.value)?void 0:o.contains((void 0).activeElement))||(d.value=!1)})),l(d,(e=>{e||setTimeout((()=>{M.value=void 0}))}),{flush:"post"});const $=p();u((()=>{$.value&&v((()=>{y.value=$.el}))}));const N=p(),R=r((()=>"cursor"===t.target&&M.value?M.value:N.value?N.el:function(e,o){var t,n;if(!e)return;let r;if("parent"===e){let e=null==(n=null==(t=null==o?void 0:o.proxy)?void 0:t.$el)?void 0:n.parentNode;for(;null==e?void 0:e.hasAttribute("data-no-activator");)e=e.parentNode;r=e}else r="string"==typeof e?(void 0).querySelector(e):"$el"in e?e.$el:e;return r}(t.target,g)||y.value)),V=r((()=>Array.isArray(R.value)?void 0:R.value));return l((()=>!!t.activator),(e=>{}),{flush:"post",immediate:!0}),i((()=>{})),{activatorEl:y,activatorRef:$,target:R,targetEl:V,targetRef:N,activatorEvents:x,contentEvents:D,scrimEvents:S}}export{d as makeActivatorProps,O as useActivator};
