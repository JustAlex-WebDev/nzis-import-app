import{useDate as e,getWeek as a}from"./date/date.mjs";import{useProxiedModel as t}from"./proxiedModel.mjs";import{computed as s}from"/Users/alexandarvalov/Documents/GitHub/nzis-import-app/node_modules/vue/index.mjs";import{propsFactory as r}from"../util/propsFactory.mjs";import{wrapInArray as n}from"../util/helpers.mjs";const l=r({allowedDates:[Array,Function],disabled:{type:Boolean,default:null},displayValue:null,modelValue:Array,month:[Number,String],max:null,min:null,showAdjacentMonths:Boolean,year:[Number,String],weekdays:{type:Array,default:()=>[0,1,2,3,4,5,6]},weeksInMonth:{type:String,default:"dynamic"},firstDayOfWeek:{type:[Number,String],default:0}},"calendar");function o(r){const l=e(),o=t(r,"modelValue",[],(e=>n(e).map((e=>l.date(e))))),d=s((()=>r.displayValue?l.date(r.displayValue):o.value.length>0?l.date(o.value[0]):r.min?l.date(r.min):Array.isArray(r.allowedDates)?l.date(r.allowedDates[0]):l.date())),i=t(r,"year",void 0,(e=>{const a=null!=e?Number(e):l.getYear(d.value);return l.startOfYear(l.setYear(l.date(),a))}),(e=>l.getYear(e))),u=t(r,"month",void 0,(e=>{const a=null!=e?Number(e):l.getMonth(d.value),t=l.setYear(l.startOfMonth(l.date()),l.getYear(i.value));return l.setMonth(t,a)}),(e=>l.getMonth(e))),m=s((()=>{const e=Number(r.firstDayOfWeek);return[0,1,2,3,4,5,6].map((a=>(a+e)%7))})),y=s((()=>{const e=Number(r.firstDayOfWeek),a=l.getWeekArray(u.value,e),t=a.flat();if("static"===r.weeksInMonth&&t.length<42){const e=t[t.length-1];let s=[];for(let r=1;r<=42-t.length;r++)s.push(l.addDays(e,r)),r%7==0&&(a.push(s),s=[])}return a}));function f(e,a){return e.filter((e=>m.value.includes(l.toJsDate(e).getDay()))).map(((e,t)=>{const s=l.toISO(e),n=!l.isSameMonth(e,u.value),d=l.isSameDay(e,l.startOfMonth(u.value)),i=l.isSameDay(e,l.endOfMonth(u.value)),m=l.isSameDay(e,u.value);return{date:e,isoDate:s,formatted:l.format(e,"keyboardDate"),year:l.getYear(e),month:l.getMonth(e),isDisabled:c(e),isWeekStart:t%7==0,isWeekEnd:t%7==6,isToday:l.isSameDay(e,a),isAdjacent:n,isHidden:n&&!r.showAdjacentMonths,isStart:d,isSelected:o.value.some((a=>l.isSameDay(e,a))),isEnd:i,isSame:m,localized:l.format(e,"dayOfMonth")}}))}const h=s((()=>{const e=l.startOfWeek(d.value,r.firstDayOfWeek),a=[];for(let t=0;t<=6;t++)a.push(l.addDays(e,t));return f(a,l.date())})),D=s((()=>f(y.value.flat(),l.date()))),p=s((()=>y.value.map((e=>e.length?a(l,e[0]):null))));function c(e){if(r.disabled)return!0;const a=l.date(e);return!(!r.min||!l.isAfter(l.date(r.min),a))||(!(!r.max||!l.isAfter(a,l.date(r.max)))||(Array.isArray(r.allowedDates)&&r.allowedDates.length>0?!r.allowedDates.some((e=>l.isSameDay(l.date(e),a))):"function"==typeof r.allowedDates?!r.allowedDates(a):!r.weekdays.includes(l.toJsDate(a).getDay())))}return{displayValue:d,daysInMonth:D,daysInWeek:h,genDays:f,model:o,weeksInMonth:y,weekDays:m,weekNumbers:p}}export{l as makeCalendarProps,o as useCalendar};
